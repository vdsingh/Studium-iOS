workflows:
    studium-ios:
        name: Studium Pipeline
        instance_type: mac_mini_m1
        environment:
          xcode: 15.0
          ios_signing:
            distribution_type: development # or: ad_hoc | development | enterprise
            bundle_identifier: com.vikramsingh.Studium
          vars:
            BUNDLE_ID: "com.vikramsingh.Studium"
            XCODE_WORKSPACE: "Studium.xcworkspace"
            XCODE_SCHEME: "Studium"
        scripts:
            - name: CICD Started
              script: echo 'CI/CD Started'
            - name: Install Cocoapods
              script: pod install
            - name: Set up provisioning profiles settings on Xcode project
              script: xcode-project use-profiles
            - name: Build ipa for distribution
              script: | 
                xcode-project build-ipa \
                  --workspace "$CM_BUILD_DIR/$XCODE_WORKSPACE" \
                  --scheme "$XCODE_SCHEME" \
        triggering:
          events:
            - pull_request
          branch_patterns:
            - pattern: 'main'
              include: true
              source: false 
          cancel_previous_builds: true